/**
 * The life and times of Dr John Dee
 * Copyright (C) 2021  Jordan Cole <feedback@drjohndee.net>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published
 * by the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

@charset "utf-8";

/* selected charsets: `greek`, `latin`, `latin-ext` */
@font-face {
  font-display: swap;
  font-family: 'EB Garamond';
  font-style: normal;
  font-weight: 400;
  src: local(''),
       url('fonts/eb-garamond-400-normal.woff2') format('woff2'),
       url('fonts/eb-garamond-400-normal.woff') format('woff');
}
@font-face {
  font-display: swap;
  font-family: 'EB Garamond';
  font-style: normal;
  font-weight: 700;
  src: local(''),
       url('fonts/eb-garamond-700-normal.woff2') format('woff2'),
       url('fonts/eb-garamond-700-normal.woff') format('woff');
}
@font-face {
  font-display: swap;
  font-family: 'EB Garamond';
  font-style: italic;
  font-weight: 400;
  src: local(''),
       url('fonts/eb-garamond-400-italic.woff2') format('woff2'),
       url('fonts/eb-garamond-400-italic.woff') format('woff');
}

/* colors */
:root {
  /* @see https://www.colorbox.io/#steps=11#hue_start=51#hue_end=31#hue_curve=easeInQuad#sat_start=1#sat_end=1#sat_curve=easeOutQuad#sat_rate=130#lum_start=100#lum_end=0#lum_curve=easeOutQuad#minor_steps_map=0 */
  --neutral-0--components: 1 1 0.9882;
  --neutral-0: #fffffc;
  --neutral-5--components: 0.9922 0.9882 0.9804;
  --neutral-5: #fdfcfa;
  --neutral-10--components: 0.9843 0.9804 0.9725;
  --neutral-10: #fbfaf8;
  --neutral-20--components: 0.9569 0.9529 0.9412;
  --neutral-20: #f4f3f0;
  --neutral-30--components: 0.9137 0.9098 0.9020;
  --neutral-30: #e9e8e6;
  --neutral-40--components: 0.8510 0.8510 0.8431;
  --neutral-40: #d9d9d7;
  --neutral-50--components: 0.7725 0.7686 0.7608;
  --neutral-50: #c5c4c2;
  --neutral-60--components: 0.6667 0.6627 0.6549;
  --neutral-60: #aaa9a7;
  --neutral-70--components: 0.5294 0.5294 0.5255;
  --neutral-70: #878786;
  --neutral-80--components: 0.3686 0.3686 0.3647;
  --neutral-80: #5e5e5d;
  --neutral-90--components: 0.1882 0.1843 0.1843;
  --neutral-90: #302f2f;
  --neutral-100--components: 0 0 0;
  --neutral-100: #000;

  /* @see https://www.colorbox.io/#steps=11#hue_start=39#hue_end=11#hue_curve=easeInQuad#sat_start=4#sat_end=90#sat_curve=easeOutQuad#sat_rate=130#lum_start=100#lum_end=53#lum_curve=easeOutQuad#minor_steps_map=0 */
  --accent-0--components: 1.0000 0.9804 0.9490;
  --accent-0: #fffaf2;
  --accent-5--components: 0.9961 0.9412 0.8992;
  --accent-5: #fef0d6;
  --accent-10--components: 0.9922 0.8980 0.7333;
  --accent-10: #fde5bb;
  --accent-20--components: 0.9804 0.8078 0.5255;
  --accent-20: #face86;
  --accent-30--components: 0.9608 0.7137 0.3412;
  --accent-30: #f5b657;
  --accent-40--components: 0.9294 0.6157 0.1882;
  --accent-40: #ed9d30;
  --accent-50--components: 0.8941 0.5098 0.0745;
  --accent-50: #e48213;
  --accent-60--components: 0.8431 0.4000 0;
  --accent-60: #d76600;
  --accent-70--components: 0.7803 0.3176 0;
  --accent-70: #c75100;
  --accent-80--components: 0.6020 0.2352 0;
  --accent-80: #b33c00;
  --accent-90--components: 0.6196 0.1568 0;
  --accent-90: #9e2800;
  --accent-100--components: 0.5294 0.0980 0;
  --accent-100: #871900;

  --background: var(--neutral-0);
  --blockquote-border-color: var(--neutral-40);
  --blockquote-content-color: var(--neutral-80);
  --calendar-filler-color: var(--neutral-80);
  --calendar-highlight-color: var(--accent-20);
  --foreground: var(--neutral-100);
  --link-color: var(--accent-80);
  --link-focus-color: var(--accent-60);
  --link-visted-color: var(--accent-100);
  --avatar-background-color: var(--neutral-10);
  --avatar-author-background-color: var(--foreground);
  --highlight-background-color: var(--accent-20);
  --highlight-outline-color: var(--accent-60);
  --highlight-alternate-background-color: var(--accent-80);
}

@supports (color: hsl(1 1 1)) {
  :root {
    --accent-0: hsl(var(--accent-0--components));
    --accent-5: hsl(var(--accent-5--components));
    --accent-10: hsl(var(--accent-10--components));
    --accent-20: hsl(var(--accent-20--components));
    --accent-30: hsl(var(--accent-30--components));
    --accent-40: hsl(var(--accent-40--components));
    --accent-50: hsl(var(--accent-50--components));
    --accent-60: hsl(var(--accent-60--components));
    --accent-70: hsl(var(--accent-70--components));
    --accent-80: hsl(var(--accent-80--components));
    --accent-90: hsl(var(--accent-90--components));
    --accent-100: hsl(var(--accent-100--components));
    --neutral-0: hsl(var(--neutral-0--components));
    --neutral-5: hsl(var(--neutral-5--components));
    --neutral-10: hsl(var(--neutral-10--components));
    --neutral-20: hsl(var(--neutral-20--components));
    --neutral-30: hsl(var(--neutral-30--components));
    --neutral-40: hsl(var(--neutral-40--components));
    --neutral-50: hsl(var(--neutral-50--components));
    --neutral-60: hsl(var(--neutral-60--components));
    --neutral-70: hsl(var(--neutral-70--components));
    --neutral-80: hsl(var(--neutral-80--components));
    --neutral-90: hsl(var(--neutral-90--components));
    --neutral-100: hsl(var(--neutral-100--components));
  }
}
@supports (color: color(display-p3 1 1 1)) {
  :root {
    --neutral-0: color(display-p3 var(--neutral-0--components));
    --neutral-5: color(display-p3 var(--neutral-5--components));
    --neutral-10: color(display-p3 var(--neutral-10--components));
    --neutral-20: color(display-p3 var(--neutral-20--components));
    --neutral-30: color(display-p3 var(--neutral-30--components));
    --neutral-40: color(display-p3 var(--neutral-40--components));
    --neutral-50: color(display-p3 var(--neutral-50--components));
    --neutral-60: color(display-p3 var(--neutral-60--components));
    --neutral-70: color(display-p3 var(--neutral-70--components));
    --neutral-80: color(display-p3 var(--neutral-80--components));
    --neutral-90: color(display-p3 var(--neutral-90--components));
    --neutral-100: color(display-p3 var(--neutral-100--components));
    --accent-0: color(display-p3 var(--accent-0--components));
    --accent-5: color(display-p3 var(--accent-5--components));
    --accent-10: color(display-p3 var(--accent-10--components));
    --accent-20: color(display-p3 var(--accent-20--components));
    --accent-30: color(display-p3 var(--accent-30--components));
    --accent-40: color(display-p3 var(--accent-40--components));
    --accent-50: color(display-p3 var(--accent-50--components));
    --accent-60: color(display-p3 var(--accent-60--components));
    --accent-70: color(display-p3 var(--accent-70--components));
    --accent-80: color(display-p3 var(--accent-80--components));
    --accent-90: color(display-p3 var(--accent-90--components));
    --accent-100: color(display-p3 var(--accent-100--components));
  }
}
@media (prefers-contrast: more) {
  :root {
    --blockquote-content-color: var(--neutral-100);
  }
}
@media (prefers-color-scheme: dark) {
  :root {
    --background: var(--neutral-100);
    --blockquote-border-color: var(--neutral-80);
    --blockquote-content-color: var(--neutral-40);
    --calendar-filler-color: var(--neutral-70);
    --calendar-highlight-color: var(--accent-80);
    --foreground: var(--neutral-0);
    --link-color: var(--accent-30);
    --link-focus-color: var(--accent-10);
    --link-visted-color: var(--accent-40);
    --avatar-background-color: var(--neutral-90);
    --highlight-background-color: var(--accent-80);
    --highlight-outline-color: var(--accent-40);
    --highlight-alternate-background-color: var(--accent-20);
  }
}
@media (prefers-color-scheme: dark) and (prefers-contrast: more) {
  :root {
    --blockquote-border-color: var(--neutral-60);
    --blockquote-content-color: var(--neutral-20);
  }
}

/* type */
:root {
  --base-font-size: 18px;
  --content-line-height: calc(var(--vertical-rhythm) * 2);
  --font-serif-local: Garamond, Times, Times New Roman, serif;
  --font-serif: EB Garamond, var(--font-serif-local);
  --font-sans-serif: system-ui, sans-serif;
}
@media (prefers-reduced-data: reduced) {
  :root {
    --font-serif: var(--font-serif-local);
  }
}

/* grid & layout */
:root {
  --body-side-spacing: auto;
  --primary-column-count: 9;
  --spacing-column-count: 1;
  --secondary-column-count: 5;
  --column-count: calc(var(--primary-column-count)
                     + var(--spacing-column-count)
                     + var(--secondary-column-count));
  --column-width: 5rem;
  --gutter-width: calc(var(--column-width) / 10);
  --content-width: calc(var(--column-count) * var(--column-width)
                      + calc(var(--column-count) - 1) * var(--gutter-width));
  --content-grid-rows: auto auto auto auto;
  --content-grid-areas:
    "header     header     header     header     header     header     header     header     header     header secondary secondary secondary secondary secondary"
    "content    content    content    content    content    content    content    content    content    . secondary secondary secondary secondary secondary"
    "commentary commentary commentary commentary commentary commentary commentary commentary commentary . secondary secondary secondary secondary secondary"
    "context    context    context    context    context    context    context    context    context    . secondary secondary secondary secondary secondary";

  --vertical-rhythm: calc(var(--gutter-width) * 2);

  --calendar-month-column-count: 3;
  --calendar-month-width: calc(var(--calendar-month-column-count) * var(--column-width)
                             + calc(var(--calendar-month-column-count) - 1) * var(--gutter-width));
  /* one week per row; used as both width and height to make cells square */
  --calendar-day-size: calc(var(--calendar-month-width) / 7);

  --avatar-border-width: 2px;
  --avatar-size: calc(var(--vertical-rhythm) * 2);

  --image-width: calc(4 * var(--column-width)
               + calc(4 - 1) * var(--gutter-width));
}
@media (min-width: 2200px) {
  :root {
    --column-width: 7rem;
  }
}
@media (max-width: 960px) {
  :root {
    --base-font-size: 20px;
    --body-side-spacing: calc(var(--gutter-width) * 2);
    --content-line-height: calc(var(--vertical-rhythm) * 2.5);
    --primary-column-count: 5;
    --secondary-column-count: 0;
    --spacing-column-count: 0;
    --column-width: 18.5vw;
    --content-grid-areas:
      "header     header     header     header     header"
      "content    content    content    content    content"
      "secondary  secondary  secondary  secondary  secondary"
      "commentary commentary commentary commentary commentary"
      "context    context    context    context    context";
  }
}

:lang(en),
:lang(en-emodeng) {
  quotes: '‘' '’' '“' '”';
}
:lang(en-Grek),
:lang(la) {
  quotes: "«" "»" "“" "”" "‘" "’";
}
:lang(en-modeng),
:lang(la-renais) {
  font-variant-alternates: historical-forms;
  font-variant-ligatures: historical-ligatures;
}

body, h1, h2, h3, h4, h5, h6,
p, blockquote, pre, hr,
dl, dd, ol, ul, figure,
table, tr, td {
  margin: 0;
  padding: 0;
}
html {
  font-size: var(--base-font-size);
}
body {
  background-color: var(--background);
  color: var(--foreground);
  color-scheme: light dark;
  font-family: var(--font-sans-serif);
  line-height: 1rem;
  margin: calc(var(--vertical-rhythm) * 3) var(--body-side-spacing)
          calc(var(--vertical-rhythm) * 2) var(--body-side-spacing);
  min-height: 100vh;
  max-width: var(--content-width);
}
a {
  color: var(--link-color);
}
a:focus,
a:hover {
  color: var(--link-focus-color);
}
a:active,
a:visited {
  color: var(--link-visted-color);
}
h1, h2, h3, h4, h5, h6,
p, blockquote, pre,
ul, ol, dl, figure {
  margin-bottom: var(--vertical-rhythm);
}
ol,
ul {
  font-size: 1rem;
}
ol > li,
ul > li {
  line-height: var(--vertical-rhythm);
  margin-bottom: var(--vertical-rhythm);
}
blockquote {
  color: var(--blockquote-content-color);
  padding-inline-start: calc(var(--gutter-width));
  position: relative;
}
blockquote::before {
  background-color: var(--blockquote-border-color);
  bottom: 0;
  content: '';
  inset-inline-start: calc(var(--gutter-width) * -0.5);
  position: absolute;
  top: 0;
  width: 4px;
}
blockquote > :last-child {
  margin-bottom: 0;
}
h1,
h2 {
  font-weight: 400;
  line-height: 1em;
}
h2 {
  line-height: calc(var(--vertical-rhythm) * 1.2);
  margin: calc(var(--vertical-rhythm) * 1.8) 0
          calc(var(--vertical-rhythm) * 0.8);
}
hr {
  border: 0;
  background-color: var(--foreground);
  height: 1px;
  inset-inline-start: 50%;
  margin-bottom: calc(var(--vertical-rhythm) * 1.5);
  margin-inline-start: -15%;
  margin-top: calc(var(--vertical-rhythm) * 1.45);
  position: relative;
  width: 30%;
}
p {
  line-height: var(--content-line-height);
}
table {
  border-collapse: collapse;
}
/* copied from Safari's Reader Mode styles */
sup {
  font-size: 0.75em;
  line-height: 1em;
}

/* @see https://webaim.org/techniques/css/invisiblecontent/ */
.is-assistiveOnly {
  height: 1px;
  left: -1px;
  overflow: hidden;
  position: absolute;
  top: auto;
  width: 1px;
}


#site-header {
  margin-bottom: calc((var(--vertical-rhythm) * 3.8));
}
#site-header h1 {
  cursor: default;
  font-size: 2rem;
  font-weight: 700;
  line-height: calc(var(--vertical-rhythm) * 2.8);
  margin: 0;
  padding-bottom: calc(var(--vertical-rhythm) * 0.2);
  text-align: start;
}

.home h2 {
  line-height: 1em;
}
.years {
  display: flex;
  flex-wrap: wrap;
  list-style: none;
  max-width: calc(var(--column-width)
                  * var(--primary-column-count));
}
.year {
  width: var(--column-width);
}
ol.years > .year {
  line-height: calc(var(--vertical-rhythm) * 2);
}


.page {
  column-gap: var(--gutter-width);
  display: grid;
  grid-template-columns: repeat(auto-fit,
                                var(--column-width));
  grid-template-rows: var(--content-grid-rows);
  grid-template-areas: var(--content-grid-areas);
  max-width: var(--content-width);
}
.page-header {
  grid-area: header;
  margin-bottom: calc(var(--vertical-rhythm) * 1.9);
}
.page-name,
.page-nextPrevious {
  display: inline-block;
  line-height: calc(var(--vertical-rhythm) * 3);
}
.page-name {
  font-size: 2.625rem;
  font-weight: 700;
  margin-bottom: calc(var(--vertical-rhythm) * 2);
  margin-top: 0;
  position: relative;
}
.page-nextPrevious {
  align-items: stretch;
  flex-direction: column;
  height: calc(var(--vertical-rhythm) * 3);
  padding-inline-start: 1rem;
  vertical-align: top;
  width: calc(var(--column-width) * 2);
}
.page-nextPrevious--isNext,
.page-nextPrevious--isPrevious {
  display: block;
  flex-grow: 1;
  /* half of container's `line-height` */
  height: calc(var(--vertical-rhythm) * 1.5);
  line-height: calc(var(--vertical-rhythm) * 1.5);
  position: relative;
  width: 100%;
}
.page-nextPrevious--isNext {
  align-self: end;
  bottom: calc(var(--vertical-rhythm) * -0.3);
}
.page-nextPrevious--isPrevious {
  align-self: start;
  top: calc(var(--vertical-rhythm) * -0.3);
}

.source-material {
  font-family: var(--font-serif);
}
.entries {
  list-style: none;
  margin-bottom: 0;
  margin-bottom: calc(var(--vertical-rhythm) * 5);
  position: relative;
}
.entries::after {
  content: '';
  display: block;
  border-bottom: 1px solid var(--foreground);
  bottom: calc(var(--vertical-rhythm) * -2.5);
  inset-inline-start: 50%;
  margin-inline-start: -15%;
  position: absolute;
  width: 30%;
}
.entries .entry {
  margin-bottom: 0;
}
.entry + .entry {
  margin-top: calc(var(--vertical-rhythm) * 2.2);
}
.entry .citation {
  display: block;
  line-height: var(--content-line-height);
  margin-bottom: calc(var(--vertical-rhythm) * 0.8);
}
.entries .page-content:last-child {
  margin-bottom: 0;
}
.entry img {
  max-width: var(--image-width);
}

.correspondence-signature {
  text-align: end;
}

.page-content {
  grid-area: content;
  line-height: 1.6rem;
  margin-bottom: calc(var(--vertical-rhythm) * 1.2);
}
.page-content--is-fullWidth {
  grid-column: span var(--column-count);
}
.page-content .e-content {
  font-size: 1.3rem;
}
.page-content blockquote {
  margin-bottom: var(--vertical-rhythm);
  margin-top: var(--vertical-rhythm);
}
.page-content p {
  margin-bottom: calc(var(--vertical-rhythm) * 1);
}
.page-content p:last-child {
  margin-bottom: 0;
}
.page-content li {
  line-height: calc(var(--vertical-rhythm) * 2);
}

.annotations h1 {
  line-height: calc(var(--vertical-rhythm) * 1.9);
  margin-bottom: calc(var(--vertical-rhythm) * 2);
}
.annotations li {
  list-style: none;
}
.annotations li + li {
  margin-top: calc(var(--vertical-rhythm) * 1.9);
}
.annotations blockquote {
  font-family: var(--font-serif);
  font-size: 1.2rem;
  margin-top: calc(var(--vertical-rhythm) * 0.1);
}
.annotations blockquote::before {
  width: 2px;
}
.annotations figcaption {
  font-size: 0.9rem;
  line-height: var(--content-line-height);
  margin-top: calc(var(--vertical-rhythm) * 1.1);
}
.annotations-commentary {
  grid-area: commentary;
}
.annotations-context {
  grid-area: context;
}
.annotations-related_dates,
.annotations-footnotes {
  grid-area: secondary;
}

.source-material em,
.source-material strong {
  text-decoration-line: underline;
  font-style: normal;
}
.source-material strong {
  text-decoration-style: double;
}

#site-footer {
  margin-top: calc(var(--vertical-rhythm) * 5);
}

.calendar {
  display: flex;
  gap: calc(var(--column-width)
          + calc(var(--gutter-width) * 2));
  flex-wrap: wrap;
  list-style: none;
  justify-content: flex-start;
}
.calendar-month {
  margin-bottom: 0;
  width: var(--calendar-month-width);
}
.calendar-monthName {
  display: block;
}
.calendar-date {
  cursor: default;
  height: var(--calendar-day-size);
  /* vertically center text */
  position: relative;
  text-align: center;
  width: var(--calendar-day-size);
}
.calendar-date a {
  height: 100%;
  inset-inline-start: 0;
  position: absolute;
  top: 0;
  width: 100%;
}
.calendar-date--filler {
  color: var(--calendar-filler-color);
}
.calendar-date--content {
  background-color: var(--calendar-highlight-color);
}

.people {
  display: flex;
  list-style: none;
}
.person-avatar,
.person-avatar a,
.person-avatarInitials {
  border-radius: 50%;
  height: var(--avatar-size);
  line-height: var(--avatar-size);
  width: var(--avatar-size);
}
.person-avatar {
  background-color: var(--avatar-background-color);
  position: relative;
}
.person-avatar--is-author {
  background-color: var(--avatar-author-background-color);
}
.person-avatar + .person-avatar {
  margin-inline-start: var(--gutter-width);
}
.person-avatar a {
  border: var(--avatar-border-width) solid currentColor;
  display: block;
  inset-inline-start: calc(var(--avatar-border-width) * -1);
  position: absolute;
  text-decoration: none;
  top: calc(var(--avatar-border-width) * -1);
}
.person-avatarInitials {
  align-items: center;
  /* trigger border-radius */
  border: 0;
  color: var(--foreground);
  display: flex;
  justify-content: center;
}
.person-avatar--is-author .person-avatarInitials {
  color: var(--background);
}
.person-avatarInitials:not(lang[he]) {
  font-size: 0.9em;
}

.is-highlighted {
  background-color: var(--highlight-background-color);
  outline: auto;
  outline-color: var(--highlight-outline-color);
}
.person-avatar--is-author .is-highlighted {
  background-color: var(--highlight-alternate-background-color);
}
